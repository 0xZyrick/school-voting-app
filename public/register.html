<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Register Your School</title>
  <link rel="icon" href="./assets/Assets/logo.jpg" type="image/jpg">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://js.paystack.co/v1/inline.js"></script>
</head>
<body>
  <div id="root"></div>

  <script type="module">
    import React, { useState } from 'https://esm.sh/react@18.2.0';
    import { createRoot } from 'https://esm.sh/react-dom@18.2.0/client';

    const BACKEND_URL = "https://school-voting-backend-5ika.onrender.com";

    const Icon = ({ children, className = "" }) => (
      React.createElement('span', { className }, children)
    );

    function RegistrationPage() {
      const [formData, setFormData] = useState({
        schoolName: '',
        email: '',
        phone: '',
        lga: '',
        state: ''
      });
      
      const [isSubmitting, setIsSubmitting] = useState(false);
      const [showSuccess, setShowSuccess] = useState(false);
      const [errorMessage, setErrorMessage] = useState('');

      const handleInputChange = (e) => {
        setFormData({
          ...formData,
          [e.target.name]: e.target.value
        });
      };

      const validateForm = () => {
        if (!formData.schoolName || !formData.email || !formData.phone || !formData.lga) {
          setErrorMessage('Please fill all required fields');
          return false;
        }
        
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(formData.email)) {
          setErrorMessage('Please enter a valid email address');
          return false;
        }
        
        return true;
      };

      const handleSubmit = () => {
        setErrorMessage('');
        
        if (!validateForm()) {
          return;
        }

        setIsSubmitting(true);

        // Initialize Paystack
        const handler = window.PaystackPop.setup({
          key: 'pk_live_615ebb0069ee567a13a7fd38571a79c25e3a0a7e', // ‚ö†Ô∏è Replace with your key
          email: formData.email,
          amount: 5000000, 
          currency: 'NGN',
          ref: 'BT-' + Math.floor((Math.random() * 1000000000) + 1),
          callback: function(response) {
            registerSchool(response.reference);
          },
          onClose: function() {
            setIsSubmitting(false);
            alert('Payment cancelled. Please try again.');
          }
        });

        handler.openIframe();
      };

      const registerSchool = async (paymentReference) => {
        try {
          const response = await fetch(`${BACKEND_URL}/api/register`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              ...formData,
              paymentReference
            })
          });

          const result = await response.json();

          if (response.ok) {
            setShowSuccess(true);
            setTimeout(() => {
              window.location.href = './vote.html';
            }, 3000);
          } else {
            setErrorMessage(result.message || 'Registration failed. Please try again.');
            setIsSubmitting(false);
          }
        } catch (error) {
          console.error('Registration error:', error);
          setErrorMessage('Something went wrong. Please try again.');
          setIsSubmitting(false);
        }
      };

      const handleCancel = () => {
        setFormData({
          schoolName: '',
          email: '',
          phone: '',
          lga: '',
          state: ''
        });
        setErrorMessage('');
      };

      return React.createElement('div', { className: 'min-h-screen bg-gradient-to-br from-green-50 via-white to-orange-50' },
        // Navigation
        React.createElement('nav', { className: 'bg-white shadow-md' },
          React.createElement('div', { className: 'max-w-7xl mx-auto px-4 sm:px-6 lg:px-8' },
            React.createElement('div', { className: 'flex justify-between items-center h-20' },
              React.createElement('div', { className: 'flex items-center space-x-3' },
                React.createElement('div', { className: 'w-12 h-12 rounded-full flex items-center justify-center' },
                  React.createElement('img', 
                  { 
                    src: './assets/Assets/logo.jpg',
                    alt:'logo',
                    className: 'text-white text-2xl font-bold' 
                    })
                ),
                React.createElement('div', null,
                  React.createElement('span', { className: 'font-bold text-xl text-green-800' }, 'Braintree Arena'),
                  React.createElement('p', { className: 'text-xs text-gray-500' }, 'School Registration')
                )
              ),
              React.createElement('button', {
                onClick: () => window.location.href = './arena.html',
                className: 'flex items-center space-x-2 text-gray-600 hover:text-green-600 transition'
              },
                React.createElement('span', null, '‚Üê Back to Home')
              )
            )
          )
        ),

        // Success Modal
        showSuccess && React.createElement('div', { className: 'fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4' },
          React.createElement('div', { className: 'bg-white rounded-2xl p-8 max-w-md w-full text-center shadow-2xl' },
            React.createElement('div', { className: 'w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6' },
              React.createElement('span', { className: 'text-5xl' }, '‚úÖ')
            ),
            React.createElement('h2', { className: 'text-3xl font-bold text-gray-900 mb-4' }, 'Registration Successful! üéâ'),
            React.createElement('p', { className: 'text-gray-600 mb-6' }, 'Your school has been registered successfully. Redirecting to voting page...'),
            React.createElement('div', { className: 'w-full bg-gray-200 rounded-full h-2' },
              React.createElement('div', { className: 'bg-green-600 h-2 rounded-full animate-pulse w-full' })
            )
          )
        ),

        // Main Content
        React.createElement('main', { className: 'max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12' },
          // Header
          React.createElement('div', { className: 'text-center mb-12' },
            React.createElement('h1', { className: 'text-4xl md:text-5xl font-bold text-gray-900 mb-4' }, 'Register Your School'),
            React.createElement('p', { className: 'text-xl text-gray-600' }, "Join Imo State's premier inter-school competition")
          ),

          // Payment Info Card
          React.createElement('div', { className: 'bg-gradient-to-r from-green-600 to-green-700 rounded-2xl p-8 text-white mb-8 shadow-xl' },
            React.createElement('div', { className: 'flex items-start space-x-4' },
              React.createElement('span', { className: 'text-4xl' }),
              React.createElement('div', { className: 'flex-1' },
                React.createElement('h3', { className: 'text-2xl font-bold mb-4' }, 'Payment Information'),
                React.createElement('div', { className: 'grid md:grid-cols-2 gap-4 bg-white bg-opacity-20 rounded-xl p-6' },
                  React.createElement('div', null,
                    React.createElement('p', { className: 'text-green-100 text-sm mb-1' }, 'Payment Method'),
                    React.createElement('p', { className: 'font-bold text-lg' }, 'Paystack')
                  ),
                  React.createElement('div', null,
                    React.createElement('p', { className: 'text-green-100 text-sm mb-1' }, 'Registration Fee'),
                    React.createElement('p', { className: 'font-bold text-2xl' }, '‚Ç¶50,000')
                  ),
                  React.createElement('div', { className: 'md:col-span-2' },
                    React.createElement('p', { className: 'text-green-100 text-sm mb-1' }, 'Account Name'),
                    React.createElement('p', { className: 'font-bold' }, 'Braintree Company')
                  )
                )
              )
            )
          ),

          // Registration Form
          React.createElement('div', { className: 'bg-white rounded-2xl shadow-xl p-8 md:p-12' },
            React.createElement('div', { className: 'space-y-6' },
              // School Name
              React.createElement('div', null,
                React.createElement('label', { className: 'flex items-center space-x-2 text-gray-700 font-semibold mb-2' },
                  React.createElement('span', { className: 'text-2xl' }),
                  React.createElement('span', null, 'School Name *')
                ),
                React.createElement('input', {
                  type: 'text',
                  name: 'schoolName',
                  value: formData.schoolName,
                  onChange: handleInputChange,
                  placeholder: 'Enter your school name',
                  className: 'w-full px-6 py-4 border-2 border-gray-200 rounded-xl focus:border-green-500 focus:outline-none transition text-lg'
                })
              ),

              // Email
              React.createElement('div', null,
                React.createElement('label', { className: 'flex items-center space-x-2 text-gray-700 font-semibold mb-2' },
                  React.createElement('span', { className: 'text-2xl' }),
                  React.createElement('span', null, 'Email Address *')
                ),
                React.createElement('input', {
                  type: 'email',
                  name: 'email',
                  value: formData.email,
                  onChange: handleInputChange,
                  placeholder: 'school@example.com',
                  className: 'w-full px-6 py-4 border-2 border-gray-200 rounded-xl focus:border-green-500 focus:outline-none transition text-lg'
                })
              ),

              // Phone
              React.createElement('div', null,
                React.createElement('label', { className: 'flex items-center space-x-2 text-gray-700 font-semibold mb-2' },
                  React.createElement('span', { className: 'text-2xl' }),
                  React.createElement('span', null, 'Phone Number *')
                ),
                React.createElement('input', {
                  type: 'tel',
                  name: 'phone',
                  value: formData.phone,
                  onChange: handleInputChange,
                  placeholder: '0801 234 5678',
                  className: 'w-full px-6 py-4 border-2 border-gray-200 rounded-xl focus:border-green-500 focus:outline-none transition text-lg'
                })
              ),

              // Location Fields
              React.createElement('div', { className: 'grid md:grid-cols-2 gap-6' },
                React.createElement('div', null,
                  React.createElement('label', { className: 'flex items-center space-x-2 text-gray-700 font-semibold mb-2' },
                    React.createElement('span', { className: 'text-2xl' }),
                    React.createElement('span', null, 'Local Government Area *')
                  ),
                  React.createElement('input', {
                    type: 'text',
                    name: 'lga',
                    value: formData.lga,
                    onChange: handleInputChange,
                    placeholder: 'Enter LGA',
                    className: 'w-full px-6 py-4 border-2 border-gray-200 rounded-xl focus:border-green-500 focus:outline-none transition text-lg'
                  })
                ),
                React.createElement('div', null,
                  React.createElement('label', { className: 'flex items-center space-x-2 text-gray-700 font-semibold mb-2' },
                    React.createElement('span', { className: 'text-2xl' }),
                    React.createElement('span', null, 'State')
                  ),
                  React.createElement('input', {
                    type: 'text',
                    name: 'state',
                    value: formData.state,
                    onChange: handleInputChange,
                    placeholder: 'Enter state',
                    className: 'w-full px-6 py-4 border-2 border-gray-200 rounded-xl focus:border-green-500 focus:outline-none transition text-lg'
                  })
                ),
              ),

              // Error Message
              errorMessage && React.createElement('div', { className: 'bg-red-50 border-2 border-red-200 rounded-xl p-4 flex items-start space-x-3' },
                React.createElement('span', { className: 'text-2xl' }, '‚ö†Ô∏è'),
                React.createElement('p', { className: 'text-red-700 font-medium' }, errorMessage)
              ),

              // Buttons
              React.createElement('div', { className: 'flex flex-col sm:flex-row gap-4 pt-6' },
                React.createElement('button', {
                  onClick: handleSubmit,
                  disabled: isSubmitting,
                  className: 'flex-1 bg-gradient-to-r from-green-600 to-green-700 text-white px-8 py-4 rounded-xl font-bold text-lg hover:shadow-lg transform hover:scale-105 transition disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none'
                }, isSubmitting ? 'Processing Payment...' : 'Proceed to Payment'),
                React.createElement('button', {
                  onClick: handleCancel,
                  className: 'flex-1 border-2 border-gray-300 text-gray-700 px-8 py-4 rounded-xl font-bold text-lg hover:bg-gray-50 transition'
                }, 'Cancel')
              )
            ),

            // Info Note
            React.createElement('div', { className: 'mt-8 bg-blue-50 border-2 border-blue-200 rounded-xl p-6' },
              React.createElement('h4', { className: 'font-bold text-blue-900 mb-2' }, 'Important Information'),
              React.createElement('ul', { className: 'space-y-2 text-blue-800 text-sm' },
                React.createElement('li', null, '‚Ä¢ Registration fee is ‚Ç¶50,000 per school'),
                React.createElement('li', null, '‚Ä¢ Payment is processed securely via Paystack'),
                React.createElement('li', null, '‚Ä¢ You will receive confirmation via email after successful registration'),
                React.createElement('li', null, '‚Ä¢ Workshop training details will be sent to your email')
              )
            )
          )
        ),

        // Footer
        React.createElement('footer', { className: 'bg-gray-900 text-white py-8 mt-20' },
          React.createElement('div', { className: 'max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center' },
            React.createElement('p', { className: 'text-gray-400' }, '¬© 2024 Braintree Company. All rights reserved.')
          )
        )
      );
    }

    // Render the app
    createRoot(document.getElementById('root')).render(React.createElement(RegistrationPage));
  </script>
</body>
</html>